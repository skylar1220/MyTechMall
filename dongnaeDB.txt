
-- 테이블 생성 SQL

--상품 테이블
DROP TABLE  if exists goods;
CREATE TABLE `Goods` (
	`g_id`	int	NOT NULL primary key AUTO_INCREMENT,
    `c1_id` int NOT NULL,
	`c2_id`	int	NOT NULL,
	`m_number`	int	NOT NULL,
	`g_name`	varchar(255)	NULL,
	`g_text`	varchar(255)	NULL,
	`g_price`	int	NOT NULL,
	`g_pic01`	varchar(255)	NULL,
	`g_pic02`	varchar(255)	NULL,
	`g_pic03`	varchar(255)	NULL,
	`g_picpath`	varchar(255)	NULL,
	`g_like`	int	NULL,
	`g_regdate`	DATETIME	NULL	DEFAULT CURRENT_TIMESTAMP,
	`g_status`	int default 1
);


DROP TABLE  if exists keyword;
CREATE TABLE `keyword` (
	`key_id`	int not null primary key  auto_increment,
	`m_number`	int	NOT NULL,
	`keyword`	varchar(255)	NOT NULL,
	`key_regdate`	datetime	NULL	DEFAULT CURRENT_TIMESTAMP
);


DROP TABLE  if exists category_goods_1;
CREATE TABLE `category_goods_1` (
	`c1_id`	int	NOT NULL primary key  auto_increment,
	`c1_category`	varchar(255)	NOT NULL
);
DROP TABLE  if exists category_goods_2;
CREATE TABLE `category_goods_2` (
	`c2_id`	int	NOT NULL PRIMARY KEY,
	`c2_category`	varchar(255)	NOT NULL,
	`c1_id`	int	NOT NULL
);



-- community 테이블 -------------------------------------------------
CREATE TABLE `community` (
  `mu_id` int NOT NULL AUTO_INCREMENT,
  `mu_name` varchar(255) NOT NULL,
  `mu_detail` longtext NOT NULL,
  `mu_c` int DEFAULT '0',
  `mu_data` datetime DEFAULT CURRENT_TIMESTAMP,
  `ca_id` int NOT NULL,
  `m_number` int NOT NULL,
  PRIMARY KEY (`mu_id`),
  UNIQUE KEY `mu_id_UNIQUE` (`mu_id`)
);

CREATE TABLE `category` (
  `ca_id` int NOT NULL AUTO_INCREMENT,
  `ca_l` varchar(255) NOT NULL,
  PRIMARY KEY (`ca_id`),
  UNIQUE KEY `ca_id_UNIQUE` (`ca_id`)
) ;

CREATE TABLE `comment` (
  `com_id` int NOT NULL AUTO_INCREMENT,
  `com_c` varchar(255) NOT NULL,
  `m_number` int NOT NULL,
  `mu_id` int NOT NULL,
  `com_data` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`com_id`),
  UNIQUE KEY `com_id_UNIQUE` (`com_id`)
) ;

CREATE TABLE `heart` (
  `h_id` int NOT NULL AUTO_INCREMENT,
  `mu_id` int NOT NULL,
  `m_number` int NOT NULL,
  `h_num` int NOT NULL,
  PRIMARY KEY (`h_id`),
  UNIQUE KEY `h_id_UNIQUE` (`h_id`)
);


create view communityall
as
select DISTINCT
	C.mu_id,Ca.ca_l, S.si_area, C.mu_name, C.mu_detail, M.m_id, C.mu_data , C.mu_c ,
	(select
count(*)
from heart
where heart.mu_id = C.mu_id ) as heart,
(select
count(*)
from comment 
where comment.mu_id =C.mu_id) as comment
from community as C, si_area as S, member as M ,category as Ca
where  C.m_number = M.m_number and M.si_id = S.si_id and Ca.ca_id = C.ca_id;




insert into category(ca_l)
values('사건사고');
insert into category(ca_l)
values('분실/실종');
insert into category(ca_l)
values('일상');
insert into category(ca_l)
values('맛집');
insert into category(ca_l)
values('취미');
insert into category(ca_l)
values('동네질문');




-- 키워드 테이블
DROP TABLE  if exists keyword;
CREATE TABLE `keyword` (
	`key_id`	int	NOT NULL primary key AUTO_INCREMENT,
	`m_number`	int	NOT NULL,
	`keyword`	varchar(255)	NOT NULL,
	`key_regdate`	datetime	NULL	DEFAULT CURRENT_TIMESTAMP
);

-- 회원 테이블
drop table if exist member; 
CREATE TABLE `Member` (
	`m_number`	int	NOT NULL	unique primary key  auto_increment,
	`m_id`	varchar(255)	NOT NULL	unique,
	`m_pwd`	varchar(255)	NOT NULL,
	`m_name`	varchar(255)	NOT NULL,
	`m_email`	varchar(255)	NOT NULL	unique,
	`m_phone`	varchar(255)	NOT NULL,
	`m_point`	int	NULL DEFAULT 0 ,
	`m_regdate`	timestamp	NULL	DEFAULT CURRENT_TIMESTAMP,
	`si_id`	int	NOT NULL,
	`do_id`	int	NULL,
    `m_pic` varchar(255)	NULL,
    `m_picpath` varchar(255)	NULL,
    `m_auth`	varchar(50)	NOT NULL	DEFAULT 'ROLE_MEMBER'
);


-- point 테이블
-- p_type 설정: plus(송금받은 경우) , minus(송금한 경우), put(충전한 경우)
drop table  if exists point; 
CREATE TABLE `point` (
	`p_id`		int	NOT NULL unique primary key  auto_increment,
	`m_number`	int	NOT NULL,
    	`p_type`	varchar(255)	NULL	,
	`p_price` int	NULL,
	`p_regdate`	timestamp	NULL DEFAULT CURRENT_TIMESTAMP
);

-- 거래 테이블
drop table  if exists deal; 
CREATE TABLE `deal` (
	`d_id`		int	NOT NULL unique primary key  auto_increment,
	`m_number`	int	NOT NULL,
   	`d_type`	varchar(255)	NULL	,
	`d_m_number`int	NULL,
	`d_regdate`	timestamp	NULL DEFAULT CURRENT_TIMESTAMP,
	`g_id`		int	NOT NULL,
	`d_score`	int	NULL,
	`d_review`	varchar(255)	NULL,
     unique ( m_number, d_type, d_m_number, g_id)
);

-- 거래 + 상품 조회 view
drop view  if exists deal_view; 
create view deal_view
as select  D.d_id, D.m_number, D.d_type, D.d_m_number, D.d_regdate, D.d_score, D.d_review, G.g_id, G.g_price, G.g_name
from deal as D, goods as G
where G.m_number = D.m_number ;

-- 찜목록 테이블
drop TABLE if exists wishlist; 
CREATE TABLE `wishlist` (
	`wish_id`	int	NOT NULL primary key auto_increment,
	`m_number`	int	NOT NULL	,
	`g_id`	int	NOT NULL,
    unique ( m_number, g_id)
);

-- 찜목록 조회 위한 wish_view
drop view  if exists wish_view; 
create view wish_view
as select W.wish_id , W.m_number  , G.g_id , G.g_name  , G.g_price
from wishlist as W, goods as G
where W.m_number = G.m_number ;

-- 시 도  테이블
drop TABLE if exists Do_area; 
CREATE TABLE `Do_area` (
	`do_id`	int	NOT NULL primary key ,
	`do_area`	varchar(255)	NOT NULL
);

drop TABLE if exists Si_area; 
CREATE TABLE `Si_area` (
	`si_id`	int	NOT NULL  primary key ,
	`si_area`	varchar(255)	NOT NULL,
	`do_id`	int	NOT NULL
);

-- 시 도  테이블 기본 데이터 insert 
insert into Do_area ( do_id, do_area ) values ('123', '서울' );
insert into Do_area ( do_id, do_area ) values ('456', '경기' );
insert into Do_area ( do_id, do_area ) values ('700', '인천' );

insert into Si_area ( si_id , si_area, do_id ) values ('10', '강남구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('11', '강동구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('12', '강북구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('13', '강서구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('14', '관악구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('15', '광진구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('16', '구로구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('17', '금천구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('18', '노원구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('19', '도봉구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('20', '동대문구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('21', '동작구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('22', '마포구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('23', '서대문구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('24', '서초구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('25', '성동구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('26', '성북구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('27', '송파구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('28', '양천구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('29', '영등포구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('30', '용산구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('31', '은평구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('32', '종로구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('33', '중구', '123' );
insert into Si_area ( si_id , si_area, do_id ) values ('34', '중랑구', '123' );

insert into Si_area ( si_id , si_area, do_id ) values ('40', '수원', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('41', '성남', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('42', '용인', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('43', '안양', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('44', '안산', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('45', '과천', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('46', '광명', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('47', '광주', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('48', '군포', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('49', '부천', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('50', '시흥', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('51', '김포', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('52', '안성', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('53', '오산', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('54', '의왕', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('55', '이천', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('56', '평택', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('57', '하남', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('58', '화성', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('59', '여주', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('60', '양평', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('61', '고양', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('62', '구리', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('63', '남양주', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('64', '동두천', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('65', '양주', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('66', '의정부', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('67', '파주', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('68', '연천・포천', '456' );
insert into Si_area ( si_id , si_area, do_id ) values ('69', '가평', '456' );

insert into Si_area ( si_id , si_area, do_id ) values ('70', '인천', '700' );
insert into Si_area ( si_id , si_area, do_id ) values ('71', '중구', '700' );
insert into Si_area ( si_id , si_area, do_id ) values ('72', '동구', '700' );
insert into Si_area ( si_id , si_area, do_id ) values ('73', '미추홀구', '700' );
insert into Si_area ( si_id , si_area, do_id ) values ('74', '연수구', '700' );
insert into Si_area ( si_id , si_area, do_id ) values ('75', '남동구', '700' );
insert into Si_area ( si_id , si_area, do_id ) values ('76', '부평구', '700' );
insert into Si_area ( si_id , si_area, do_id ) values ('77', '계양구', '700' );
insert into Si_area ( si_id , si_area, do_id ) values ('78', '서구', '700' );
insert into Si_area ( si_id , si_area, do_id ) values ('79', '강화・웅진군', '700' );




-- 카테고리 sample 목록
insert into category_goods_1 (c1_category) values ('수입명품');
insert into category_goods_1 (c1_category) values ('패션의류');
insert into category_goods_1 (c1_category) values ('패션잡화');
insert into category_goods_1 (c1_category) values ('뷰티');
insert into category_goods_1 (c1_category) values ('모바일/태블릿');
insert into category_goods_1 (c1_category) values ('가전제품');
insert into category_goods_1 (c1_category) values ('노트북/PC');
insert into category_goods_1 (c1_category) values ('카메라/캠코더');
insert into category_goods_1 (c1_category) values ('가구/인테리어');
insert into category_goods_1 (c1_category) values ('리빙/생활');
insert into category_goods_1 (c1_category) values ('게임');
insert into category_goods_1 (c1_category) values ('반려동물');
insert into category_goods_1 (c1_category) values ('도서/음반');
insert into category_goods_1 (c1_category) values ('스포츠');
insert into category_goods_1 (c1_category) values ('공구/산업용품');
insert into category_goods_1 (c1_category) values ('무료나눔');

insert into category_goods_2(c2_id, c1_id , c2_category) values (101 ,1, '여성신발');
insert into category_goods_2(c2_id, c1_id , c2_category) values (102, 1, '남성신발');
insert into category_goods_2(c2_id, c1_id , c2_category) values (103, 1, '가방/핸드백');
insert into category_goods_2(c2_id, c1_id , c2_category) values (104, 1, '지갑/벨트');
insert into category_goods_2(c2_id, c1_id , c2_category) values (105, 1, '여성의류');
insert into category_goods_2(c2_id, c1_id , c2_category) values (106, 1, '남성의류');
insert into category_goods_2(c2_id, c1_id , c2_category) values (107, 1, '패션잡화');
insert into category_goods_2(c2_id, c1_id , c2_category) values (108, 1, '시계/쥬얼리');
insert into category_goods_2(c2_id, c1_id , c2_category) values (109, 1, '유아');
insert into category_goods_2(c2_id, c1_id , c2_category) values (110, 1, '기타');



insert into category_goods_2(c2_id, c1_id , c2_category) values (201, 2, '여성의류');
insert into category_goods_2(c2_id, c1_id , c2_category) values (202, 2, '남성의류');
insert into category_goods_2(c2_id, c1_id , c2_category) values (203, 2, '교복/단체복');

insert into category_goods_2(c2_id, c1_id , c2_category) values (301, 3, '운동화');
insert into category_goods_2(c2_id, c1_id , c2_category) values (302, 3, '여성신발');
insert into category_goods_2(c2_id, c1_id , c2_category) values (303, 3, '남성신발');
insert into category_goods_2(c2_id, c1_id , c2_category) values (304, 3, '가방/핸드백');
insert into category_goods_2(c2_id, c1_id , c2_category) values (305, 3, '지갑/벨트');
insert into category_goods_2(c2_id, c1_id , c2_category) values (306, 3, '악세서리/귀금속');
insert into category_goods_2(c2_id, c1_id , c2_category) values (307, 3, '시계');
insert into category_goods_2(c2_id, c1_id , c2_category) values (308, 3, '선글라스/안경');
insert into category_goods_2(c2_id, c1_id , c2_category) values (309, 3, '모자');
insert into category_goods_2(c2_id, c1_id , c2_category) values (310, 3, '기타/잡화');


insert into category_goods_2(c2_id, c1_id , c2_category) values (501,5, '스마트폰_삼성');
insert into category_goods_2(c2_id, c1_id , c2_category) values (502, 5, '스마트폰_애플');
insert into category_goods_2(c2_id, c1_id , c2_category) values (503, 5, '스마트폰_엘지');
insert into category_goods_2(c2_id, c1_id , c2_category) values (504, 5, '스마트폰_기타');
insert into category_goods_2(c2_id, c1_id , c2_category) values (505, 5, '태블릿PC_삼성');
insert into category_goods_2(c2_id, c1_id , c2_category) values (506, 5, '태블릿PC_애플');
insert into category_goods_2(c2_id, c1_id , c2_category) values (507, 5, '태블릿PC_기타');
insert into category_goods_2(c2_id, c1_id , c2_category) values (508, 5, '스마트워치');
insert into category_goods_2(c2_id, c1_id , c2_category) values (509, 5, '일반/피처폰');
insert into category_goods_2(c2_id, c1_id , c2_category) values (510, 5, '케이스/거치대/보호필름');
insert into category_goods_2(c2_id, c1_id , c2_category) values (511, 5, '배터리/충전기/케이블');
insert into category_goods_2(c2_id, c1_id , c2_category) values (512, 5, '메모리/젠더/리더기');

insert into category_goods_2(c2_id, c1_id , c2_category) values (601, 6, '냉장고');
insert into category_goods_2(c2_id, c1_id , c2_category) values (602, 6, 'TV');
insert into category_goods_2(c2_id, c1_id , c2_category) values (603, 6, '세탁기/건조기');
insert into category_goods_2(c2_id, c1_id , c2_category) values (604, 6, '주방가전');
insert into category_goods_2(c2_id, c1_id , c2_category) values (605, 6, '스마트홈');
insert into category_goods_2(c2_id, c1_id , c2_category) values (606, 6, '영상가전');
insert into category_goods_2(c2_id, c1_id , c2_category) values (607, 6, '음향가전');
insert into category_goods_2(c2_id, c1_id , c2_category) values (608, 6, '계절가전');
insert into category_goods_2(c2_id, c1_id , c2_category) values (609, 6, '생활가전');
insert into category_goods_2(c2_id, c1_id , c2_category) values (610, 6, '미용가전');
insert into category_goods_2(c2_id, c1_id , c2_category) values (611, 6, '기타가전');

insert into category_goods_2(c2_id, c1_id , c2_category) values (701, 7, '노트북_삼성');
insert into category_goods_2(c2_id, c1_id , c2_category) values (702, 7, '노트북_엘지');
insert into category_goods_2(c2_id, c1_id , c2_category) values (703, 7, '맥북');
insert into category_goods_2(c2_id, c1_id , c2_category) values (704, 7, '데스크탑PC');
insert into category_goods_2(c2_id, c1_id , c2_category) values (705 ,7, '모니터');
insert into category_goods_2(c2_id, c1_id , c2_category) values (706, 7, '컴퓨터부품');
insert into category_goods_2(c2_id, c1_id , c2_category) values (707, 7, '키보드/마우스');
insert into category_goods_2(c2_id, c1_id , c2_category) values (708, 7, '스피커');
insert into category_goods_2(c2_id, c1_id , c2_category) values (709, 7, '프린터/복합기');
insert into category_goods_2(c2_id, c1_id , c2_category) values (710, 7, '공유기/랜카드');
insert into category_goods_2(c2_id, c1_id , c2_category) values (711, 7, '소프트웨어');
insert into category_goods_2(c2_id, c1_id , c2_category) values (712, 7, '기타 주변기기');

